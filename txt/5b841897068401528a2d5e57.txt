Pope Francis must resign. That conclusion is unavoidable if allegations contained in a letter written by Archbishop Carlo Maria Viganò are true. Archbishop Viganò, the Vatican’s ambassador to the United States from 2011 to 2016, says that Pope Francis knew Cardinal Theodore McCarrick had abused seminarians, but nonetheless lifted penalties imposed on Cardinal McCarrick by Pope Benedict XVI.  No matter what Francis does now, the Catholic Church has been plunged into all-out civil war. On one side are the traditionalists, who insist that abuse can be prevented only by tighter adherence to church doctrine. On the other side are the liberals, who demand that the church cease condemning homosexual acts and allow gay priests to step out of the closet. Despite their opposing views, the two sides have important things in common. Both believe that a culture of lies has enabled predators to flourish. And both trace this culture back to the church’s hypocritical practice of claiming that homosexual acts are wrong while quietly tolerating them among the clergy. As the liberal Vatican observer Robert Mickens writes, “There is no denying that homosexuality is a key component to the clergy sex abuse (and now sexual harassment) crisis.” James Alison, himself a gay priest, observes, “A far, far greater proportion of the clergy, particularly the senior clergy, is gay than anyone has been allowed to understand,” and many of those gay clergymen are sexually active. Father Alison describes the “absurd and pharisaical” rules of the clerical closet, which include “doesn’t matter what you do so long as you don’t say so in public or challenge the teaching.” The importance of not challenging church teaching is seen in the contrast of two gay-priest scandals of the Francis pontificate. The first is the case of Msgr. Battista Ricca, a Vatican diplomat who, while stationed in Uruguay, reportedly lived with a man, was beaten at a cruising spot and once got stuck in an elevator with a rent boy. (In Uruguay, the age of consent is 15.) These facts were concealed from Pope Francis, who in 2013 appointed Monsignor Ricca to a position of oversight at the Vatican Bank. After Monsignor Ricca’s sins were exposed, Francis chose to stand by him, famously saying, “Who am I to judge?” Msgr. Krzysztof Charamsa suffered a less happy fate. The priest, who worked at the Vatican’s Congregation for the Doctrine of Faith, announced in 2015 that he was gay and had a male partner, and asked the church to change its teaching. He was immediately fired. Both Monsignor Ricca and Monsignor Charamsa had sinned, but only one had stepped out of line. The other rule of the clerical closet is not violating the civil law — or at least not getting caught. Francis defended Monsignor Ricca by distinguishing between sins and crimes: “They are not crimes, right? Crimes are something different.” This distinction provides cover for sex abuse. When countless priests are allowed to live double lives, it is hard to tell who is concealing crimes. Cardinal McCarrick was widely seen as “merely” preying on adult seminarians. Now he has been credibly accused of sexual abuse of a minor. Corrupt as this situation is, many Catholic leaders prefer it to the coming civil war. That seemed to be the attitude of Bishop Robert Barron when he called for an investigation that avoids “ideological hobby horses” like priestly celibacy and homosexuality. Bishop Barron is right to insist that accountability comes first. This is why anyone implicated in cover-up — up to and including Pope Francis — needs to resign.  But even if all the men at fault are held accountable, the hypocrisy will continue. The real danger the church faces is not ideological challenge from left or right but a muddled modus vivendi that puts peace before truth.  In 2005 the Vatican attempted to address this problem by instructing seminaries to turn away men with “deep-seated homosexual tendencies.” But several Catholic leaders immediately indicated that they would not abide by this rule. Because Pope Benedict did nothing to enforce the decree, it became yet another symbol of Catholic hypocrisy. According to Catholic teaching, every act of unchastity leads to damnation. But many bishops would rather save face than prevent the ruin of bodies and souls. If the church really does believe that homosexual acts are always and everywhere wrong, it should begin to live what it teaches. This would most likely mean enforcing the 2005 decree and removing clergy members caught in unchastity. If the church does not believe what it says — and there are now many reasons to think that it does not — it should officially reverse its teaching and apologize for centuries of pointless cruelty. Either way, something must change. Marie Collins, a sex abuse survivor, warned that the crisis in the church is bound to get worse: “More and more countries are going to come forward, and as victims find their voices, it’s going to grow bigger.” Everyone who wants to end sex abuse should pray that the Catholic civil war does not end in stalemate. Matthew Schmitz is a senior editor at First Things and a Robert Novak Journalism Fellow.  Follow The New York Times Opinion section on Facebook and Twitter (@NYTopinion), and sign up for the Opinion Today newsletter. 