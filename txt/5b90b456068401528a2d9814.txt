STOCKHOLM — To understand why Sweden, a bastion of social democracy, might end up with a far-right party in government after national elections on Sunday, you need to take a walk with Ahmed Abdirahman.  An American-educated Somali immigrant who works as a policy analyst at the Stockholm Chamber of Commerce, Mr. Abdirahman grew up and now lives in the suburb of Rinkeby-Tensta, where some 90 percent of residents have a foreign background, roughly 80 percent live on welfare or earn low incomes and 42 percent are under age 25. It is a violent place: Sixteen people were killed there in 2016, mostly in drug-related conflicts, an unheard-of number in this typically peaceful country. As we walk along one of its main streets at 7 p.m., shopkeepers pull down the metal shutters in front of their windows, while young masked men on scooters start speeding through the streets. A police helicopter hovers overhead. The segregation and violence of Rinkeby-Tensta, and the likelihood that the far-right, anti-immigrant Sweden Democrats party will win the most votes in this weekend’s national elections, are both the result of the country’s long-running unwillingness to deal with the realities of its immigration crisis. For decades, Sweden, once a racially and culturally homogeneous country with an expansive social welfare system, insisted that it could absorb large numbers of non-European migrants without considering how those migrants should be integrated into Swedish society.  As they did in cities across Western Europe, migrants tended to cluster in low-income neighborhoods; facing poor job prospects and rampant employment discrimination, they naturally turned inward. More young women have started wearing the hijab recently, Mr. Abdirahman tells me, and more young men “internalize the otherness” — rejected by their new society, they embrace the stereotypes imposed upon them. This can lead to a point where they reject gay rights or liberalism as “white, Western ideas,” and even attack firefighters because they represent the state. As we walk around, Mr. Abdirahman, who is single and childless, confesses: “When I came here in 1998, to me this place was paradise. Today, I wouldn’t want my children to grow up here.” Mr. Abdirahman says he was lucky: His mother encouraged him to contribute to society and get a good education. He earned a degree in international studies in New York, then worked in Geneva and with the United States Embassy here before going to work with the chamber of commerce. Not all immigrants get the same push at home, he says; some parents discouraged their youngsters from going to the city center to mix. Sweden, he is afraid, has entered a vicious circle of immigration, segregation and growing mutual hostility. The situation grew worse with the latest mass influx of refugees, in 2015, after which a number of suburbs became almost exclusively migrant. Considered “no go” areas by some Swedes, these neighborhoods are known to outsiders only from horrific headlines. What people don’t get to see, Mr. Abdirahman worries, is the bus driver or the cleaning lady working themselves ragged to get their children into a university.  None of this is new, and yet the government, dominated by the traditionally strong Social Democrats and the centrist Moderate Party, did far too little. That left an opening for the Sweden Democrats, until recently a group relegated to the racist fringe of Swedish politics. In the past few years, the party has recast itself; just like the populist Alternative für Deutschland party in Germany and the Five Star Movement in Italy, it has repositioned itself as anti-establishment and anti-immigrant. The Sweden Democrats accuses all other political actors and the media of “destroying” Sweden, calls for a suspension of the right to asylum and promotes an exit of Sweden from the European Union.  The party has clocked up to 20 percent in the latest polls, enough to make a coalition government between the Social Democrats and the Moderate Party unlikely — and raising the chances that one of those parties will have to enter into a government with the Sweden Democrats. “If the major parties had been able to read the majority’s concerns, things would have been different,” Mr. Abdirahman says.  Similar stories have played out across Western Europe, from the Netherlands to Austria. But Sweden always imagined itself as something different, a society bound by its unique brand of togetherness. But that self-satisfaction justified a myopic approach to the very complex problem of how to integrate vast numbers of foreigners. If you believe in giving everyone a state-of-the-art apartment, social welfare and child benefits, then it’s unlikely you will tackle the hurdles of the highly regulated Swedish labor market. The anti-establishment Sweden Democrats profit from the fact that they were often the first to point to the downsides of immigration. Yet as much as they despise wishful thinking, they replace it with simplistic thinking. No matter what problems there might be in Sweden — housing shortages, school closings, an overburdened health care system — in the view of the Sweden Democrats, it is always one group’s fault: migrants. Andreas Johansson Heinö, an analyst with the think tank Timbro, believes that many Swedes will vote for the Sweden Democrats on Sept. 9 even though they see through the party’s crude thinking. He sees similarities to the United States, where a considerable number of people say they voted for Donald Trump not because they liked him but because they liked the idea of change. Even if the Sweden Democrats win big on Sunday, the election might be a force for good. The Moderate Party, which is likely to take second place, might split over the question of whether to rule with them. And the Social Democrats, already under pressure to move to the left, might likewise fall apart. Sweden’s party landscape, in other words, might be blown to pieces. If the country is lucky, some parts from this explosion will bind together as a new force — one that takes seriously the need for realism on immigration and integration, without falling for the siren song of right-wing populism. Jochen Bittner is a political editor of the weekly newspaper Die Zeit and a contributing opinion writer. Follow The New York Times Opinion section on Facebook and Twitter (@NYTopinion).