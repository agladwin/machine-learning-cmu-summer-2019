LONDON — In private, even some of Theresa May’s most ardent supporters concede that she is a reluctant decision maker. But after the attempted assassination of Sergei Skripal and his daughter, Yulia, the British prime minister had no choice but to do something. Mr. Skripal, a former Russian double agent who was released to Britain in 2010, appears to have been poisoned with a Russian-made nerve agent while eating with his daughter at an Italian restaurant in the town of Salisbury in southern England. There have been several suspicious deaths of Russians in Britain in recent years, but the authorities have declined to investigate most of them because they were considered domestic conflicts that happened to be played out in London. The poisoning of Mr. Skripal, who had provided information to Britain, appears to be different. He had been part of a spy swap; it was believed he was safe from retaliation. On Wednesday, Mrs. May announced her decision: the expulsion of 23 Russian diplomats who Britain believes are engaged in espionage. It was not an insignificant move, and Russia has indicated it will respond with tit-for-tat expulsions. But the prime minister should have gone in harder. If she really wanted to teach Russia a lesson, she should have announced measures allowing her government to scrutinize the billions of dollars invested in Britain by Russian oligarchs and their associates, some of whom have criminal or intelligence backgrounds. This kind of transparency would hit President Vladimir Putin and his allies where it hurts most: their bank accounts. To this day, anybody from Mexican cartels to Saudi arms dealers to Russian oligarchs (and even American real estate magnates) can invest money in Britain through anonymous companies registered in Crown Overseas Territories like the British Virgin Islands. In London’s central borough of Westminster alone, some 10,000 apartments and houses are owned by companies whose proprietors are entirely unknown to the government. In 2016, Mrs. May’s predecessor, David Cameron, was preparing legislation to force anonymous companies to reveal their real owners. Then he lost the referendum on Britain’s membership in the European Union and found himself out of power. After Mrs. May took over, she postponed introduction of the legislation, claiming the need for further consultation. The crisis with Russia right now would have been the perfect opportunity to bring the law before Parliament. Mrs. May probably has her reasons for not going forward with the law. She is the country’s weakest prime minister to assume office since World War II. Brexit has not only polarized public opinion but also created bitter divisions in her cabinet, and several ministers are open about their desire to take her place. Because of this, she has had to handle the relationship with Russia after the murder attempt with great care. If she gets it wrong, her already enfeebled administration could collapse. And she’s hardly any stronger on the world stage. Britain’s European allies are tired of the hectoring language used by British ministers negotiating Brexit, and at first they used this crisis to express their frustration. For several days, President Emmanuel Macron of France pointedly refused to blame Russia for the assassination attempt, saying he needed more conclusive proof. On Thursday, though, Germany, France and the United States came around to issuing a joint statement condemning the poisoning. Mr. Putin may have realized how weak Mrs. May is, which is why he would decide to act now to take revenge on a man he sees as a traitor and to cause Britain new headaches. Russia’s motivation is understandable. Its economy faces serious structural problems, including a dangerous overreliance on oil and gas. At the same time, business leaders are worried about the country’s long-term demographic decline. Mr. Putin seeks to bolster his domestic popularity by looking powerful as he sows discord with the West. And Britain has made itself an easy target for Russian intrigue. To be fair, this is not a problem of Mrs. May’s making. The government is reaping the dubious rewards of having opened the City of London since the late 1990s to foreign capital with no questions asked about its origin. The initial aim of this permissive approach was to persuade investors that London — rather than New York — was best suited to be the world’s financial capital. Among the many to take advantage of the light-touch regulations were oligarchs, spies and gangsters. Britain needs to make a concerted effort to ascertain where all of this fabulous wealth comes from. Russian oligarchs have made an indelible mark on London. Some own newspapers, others our most successful soccer clubs, while many more own huge chunks of high-end property in the most fashionable parts of the capital. And some of those characters are close collaborators and friends of President Putin. British newspapers have been full of articles about Russian oligarchs and their relatives buying luxury London houses through anonymous companies. Reports say that this is now an ever more popular trick — squirreling away corrupt money by passing it on to relatives in the hope that it will evade scrutiny. If Mrs. May is convinced that Russia is behind this attack, then she needs to devise a way of getting to President Putin’s friends and collaborators. And that means great transparency. She should reintroduce the stalled proposal to force anonymous companies to reveal the sources of their cash. If any members of Parliament or the cabinet tried to oppose a move now, their motives would immediately look suspicious. Now is the moment to confound her critics by acting decisively. If Britain knows where the money is coming from, it can develop smarter sanctions against Mr. Putin’s inner circle. But that information has the added advantage of making it easier to spot criminal money from across the world being laundered through London’s real estate and financial industries. If Moscow is indeed responsible for the poisoning of Mr. Skripal and his daughter, then the attempted murders look like another tactic in a strategy that seeks to exploit the political vulnerabilities of our democracies. But unlike fake news and the meddling in elections, this one could prove deadly.